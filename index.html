<!DOCTYPE html>
<html>
<head>
<title>Pat-Pat Motion Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body {
    background: radial-gradient(circle, #000010, #000000);
    margin: 0;
    overflow: hidden;
    font-family: 'Orbitron', sans-serif;
    color: #4af0f8;
    text-align: center;
  }
  canvas {
    display: block;
    margin: auto;
    background: rgba(10,10,40,0.95);
    box-shadow: 0 0 40px #4af0f8;
    border: 2px solid #4af0f8;
  }
  #hud {
    position: absolute;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    text-shadow: 0 0 10px #4af0f8;
    font-size: 18px;
  }
</style>
</head>
<body>

<div id="hud">Level: <span id="level">1</span></div>
<canvas id="gameCanvas" width="400" height="600"></canvas>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

let ball = { x: 200, y: 500, radius: 10, vx: 0, vy: 0 };
let hole = { x: 100, y: 100, radius: 15 };
let level = 1;
let walls = [
  { x: 50, y: 200, w: 300, h: 10 },
  { x: 100, y: 400, w: 200, h: 10 }
];
let ax = 0, ay = 0;

if (window.DeviceMotionEvent) {
  window.addEventListener('devicemotion', (e) => {
    ax = e.accelerationIncludingGravity.x || 0;
    ay = e.accelerationIncludingGravity.y || 0;
  });
} else {
  alert("Motion control not supported");
}

function resetHole() {
  hole.x = Math.random() * (canvas.width - 40) + 20;
  hole.y = Math.random() * (canvas.height - 40) + 20;
}

function drawBall() {
  ctx.beginPath();
  ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI*2);
  ctx.fillStyle = '#4af0f8';
  ctx.shadowColor = '#4af0f8';
  ctx.shadowBlur = 20;
  ctx.fill();
  ctx.closePath();
}

function drawHole() {
  ctx.beginPath();
  ctx.arc(hole.x, hole.y, hole.radius, 0, Math.PI*2);
  ctx.fillStyle = '#000';
  ctx.strokeStyle = '#4af0f8';
  ctx.lineWidth = 3;
  ctx.shadowColor = '#4af0f8';
  ctx.shadowBlur = 15;
  ctx.fill();
  ctx.stroke();
  ctx.closePath();
}

function drawWalls() {
  ctx.shadowBlur = 0;
  ctx.fillStyle = '#4af0f8';
  walls.forEach(w => {
    ctx.fillRect(w.x, w.y, w.w, w.h);
  });
}

function updateBall() {
  // Fixed controls: left is left, up is up
  ball.vx += ax * 0.1;
  ball.vy += ay * 0.1;

  let nextX = ball.x + ball.vx;
  let nextY = ball.y + ball.vy;

  // Wall boundaries
  if (nextX - ball.radius < 0) { nextX = ball.radius; ball.vx = 0; }
  if (nextX + ball.radius > canvas.width) { nextX = canvas.width - ball.radius; ball.vx = 0; }
  if (nextY - ball.radius < 0) { nextY = ball.radius; ball.vy = 0; }
  if (nextY + ball.radius > canvas.height) { nextY = canvas.height - ball.radius; ball.vy = 0; }

  // Solid obstacle collision
  let blocked = false;
  walls.forEach(w => {
    if (nextX + ball.radius > w.x && nextX - ball.radius < w.x + w.w &&
        nextY + ball.radius > w.y && nextY - ball.radius < w.y + w.h) {
      blocked = true;
    }
  });

  if (!blocked) {
    ball.x = nextX;
    ball.y = nextY;
  } else {
    ball.vx = 0;
    ball.vy = 0;
  }

  ball.vx *= 0.98;
  ball.vy *= 0.98;

  // Check hole collision
  let dx = ball.x - hole.x;
  let dy = ball.y - hole.y;
  let dist = Math.sqrt(dx*dx + dy*dy);
  if (dist < ball.radius + hole.radius) {
    level++;
    document.getElementById('level').innerText = level;
    resetHole();
  }
}

function gameLoop() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawHole();
  drawWalls();
  drawBall();
  updateBall();
  requestAnimationFrame(gameLoop);
}

resetHole();
gameLoop();
</script>

</body>
</html>
